---
title: "hw3-allyson-beach"
author: Allyson Beach
date: 10-01-2021
output:
  distill::distill_article:
    self_contained: false
draft: true
---


```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(stringr)
library(rmarkdown)
data_path <- "../../_data/"
knitr::opts_chunk$set(echo = TRUE)
```

## Read In Advance Dataset: Railroad 

```{r option1, include=TRUE}
# OPTION 1: select names of column names that you want - not good for lots of data 
trains_path <- paste(data_path, "StateCounty2012.xls", sep="")
trains <- read_excel(trains_path, skip=3) %>% 
  select(STATE, COUNTY, TOTAL)

# further improvements - insert column names and call certain ones delete to remove later

```

Notes, select is for columns and filter is for rows 

```{r option2}
# OPTION 2: name columns to make it easy to delete them  - be sure to skip the old col names
trains <- read_excel(trains_path, skip=4, 
                     col_names = c("State", "D1", "County", "D2", "Total")) %>% 
  select(!starts_with("d")) %>% 
  filter(!str_detect(State, "[Tt]otal")) #will look for both cases Total or total
trains

```

Next to try is the Australian Marriage Data 
Figure out the structure of the data for end results. The case are the things that uniquely id a value. Separate out the left col - into division and state 

Another one to try is the organiceggpoultry.xlsx - have to pivot (so maybe next week)

egg - what is the case? for product, year, the price per month?
so price is our value 
variables are year, month, product (amount[dozen/half] and size[large/xlarge])
SO, the case is year, month, size, and amount with the value of price
end product should have 5 columns 

for month, pivot longer 

```{r eggs_dirty}

# here we skip the empty rows and the inaccurate header row, then we rename the first column with the header "egg_month"
eggs_path <- paste(data_path, "organiceggpoultry.xls", sep="")
eggs_dirty <- read_excel(eggs_path, sheet=1, skip=4) %>%
  rename(egg_month = 1) 

# show the raw data 
print(eggs_dirty, width = Inf)

# we then take out any columns that have only NA - compare #NA to #rows
eggs_dirty <- eggs_dirty %>% select_if(!colSums(is.na(eggs_dirty)) == nrow(eggs_dirty))

# convert all types to characters so we can pivot, then we pivot the products to price and replace all of the "too few" responses in price to 0
eggs_dirty <- eggs_dirty %>% mutate(across(where(is.double), as.character)) %>% pivot_longer(cols = contains("doz"),names_to = "egg products", values_to = "price per carton") %>% 
  pivot_longer(cols=contains(c("whole", "breast", "leg", "thigh")), names_to = "chicken products", values_to = "price per lb") %>% 
  mutate(`price per carton` = str_replace(`price per carton`, "[a-zA-Z ]+", "0")) %>% 
  mutate(`price per lb`= str_replace(`price per lb`, "[a-zA-Z ]+", "0"))

# take out any of the "/1" that got filled in instead of the year (month (o)year|/1) to (month (o)year), then separate the column egg_month to month and year  
eggs_dirty <- eggs_dirty %>% mutate(egg_month = str_remove(egg_month, "/[0-9]+")) %>% 
  separate(egg_month, c("month", "year"), extra = "drop", fill = "right")

# filling in the year from the jan month to the rest of the months, default direction is down
eggs_dirty <- eggs_dirty %>% fill(year) 

# further separate the products into type and amount?? not sure 
eggs_clean <- eggs_dirty %>% 
  mutate(`price per carton`, `price per carton`=as.double(`price per carton`)) %>% 
  mutate(`price per lb`, `price per lb`=as.double(`price per lb`))

# show the clean data 
eggs_clean
```
